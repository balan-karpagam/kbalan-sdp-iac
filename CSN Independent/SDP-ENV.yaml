AWSTemplateFormatVersion: "2010-09-09"
Parameters: 
    VpcId: 
      Type: AWS::EC2::VPC::Id
      Description: Choose which VPC the security groups should be deployed to
Resources:
  SecurityGroup:
    Type: AWS::EC2::SecurityGroup
    Properties: 
      VpcId: !Ref VpcId
      GroupDescription: Security group for SDP environment
  InboundRule1:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !GetAtt SecurityGroup.GroupId
      IpProtocol: tcp
      FromPort: '80'
      ToPort: '80'
   
  InboundRule2:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !GetAtt SecurityGroup.GroupId
      IpProtocol: tcp
      FromPort: '8080'
      ToPort: '8080'
  
  InboundRule3:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !GetAtt SecurityGroup.GroupId
      IpProtocol: tcp
      FromPort: '50000'
      ToPort: '50000'
   
 
  InboundRule4:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !GetAtt SecurityGroup.GroupId
      IpProtocol: tcp
      FromPort: '9000'
      ToPort: '9000'

  InboundRule5:
    Type: 'AWS::EC2::SecurityGroupIngress'
    Properties:
      GroupId: !GetAtt SecurityGroup.GroupId
      IpProtocol: tcp
      FromPort: '5432'
      ToPort: '5432'
  
  OutboundRule:
    Type: AWS::EC2::SecurityGroupEgress
    Properties:
      IpProtocol: tcp
      FromPort: 0
      ToPort: 65535
  
Outputs:
  SecurityGroups:
        Description: A list of the security groups.
        Value: !Join [ ",", [ !Ref SecurityGroup ]]